<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Filip Strnad, Simon Papalexiou, Yannis Markonis, Francesco Serinaldi" />

<meta name="date" content="2020-06-25" />

<title>CoSMoS - A Complete Stochatic Modelling Solution</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">CoSMoS - A Complete Stochatic Modelling Solution</h1>
<h4 class="author">Filip Strnad, Simon Papalexiou, Yannis Markonis, Francesco Serinaldi</h4>
<h4 class="date">2020-06-25</h4>


<div id="TOC">
<ul>
<li><a href="#section_1"><span class="toc-section-number">1</span> Step by step guide to timeseries simulation</a><ul>
<li><a href="#define-marginal-distribution"><span class="toc-section-number">1.1</span> Define marginal distribution</a></li>
<li><a href="#generate-uncorrelated-time-series"><span class="toc-section-number">1.2</span> Generate uncorrelated time series</a></li>
<li><a href="#autocorrelation"><span class="toc-section-number">1.3</span> Autocorrelation</a></li>
<li><a href="#intermittency"><span class="toc-section-number">1.4</span> Intermittency</a></li>
<li><a href="#validating-the-results"><span class="toc-section-number">1.5</span> Validating the results</a></li>
</ul></li>
<li><a href="#section_2"><span class="toc-section-number">2</span> Random vector and random field simulation</a><ul>
<li><a href="#spatiotemporal-correlation-functions"><span class="toc-section-number">2.1</span> Spatiotemporal correlation functions</a></li>
<li><a href="#random-vector-simulation"><span class="toc-section-number">2.2</span> Random vector simulation</a></li>
<li><a href="#random-field-simulation"><span class="toc-section-number">2.3</span> Random field simulation</a></li>
<li><a href="#validating-the-simulated-random-fields"><span class="toc-section-number">2.4</span> Validating the simulated random fields</a></li>
</ul></li>
<li><a href="#section_3"><span class="toc-section-number">3</span> Stochastic Simulation of real-world processes</a><ul>
<li><a href="#hourly-precipitation"><span class="toc-section-number">3.1</span> Hourly precipitation</a></li>
<li><a href="#daily-streamflow"><span class="toc-section-number">3.2</span> Daily streamflow</a></li>
</ul></li>
<li><a href="#section_4"><span class="toc-section-number">4</span> Available distributions in CoSMoS package</a><ul>
<li><a href="#burr-type-iii-distribution"><span class="toc-section-number">4.1</span> Burr type III distribution</a></li>
<li><a href="#burr-type-xii-distribution"><span class="toc-section-number">4.2</span> Burr type XII distribution</a></li>
<li><a href="#generalized-gamma-distribution"><span class="toc-section-number">4.3</span> Generalized gamma distribution</a></li>
<li><a href="#paretto-type-ii-distribution"><span class="toc-section-number">4.4</span> Paretto type II distribution</a></li>
</ul></li>
<li><a href="#references"><span class="toc-section-number">5</span> References</a></li>
</ul>
</div>

<hr />
<p><strong>Vignette with figures can be found <a href="http://rpubs.com/Strnda/CoSMoS">here</a>.</strong></p>
<hr />
<p><em>Hydroclimatic processes come in all “shapes and sizes”. They are characterized by different spatiotemporal correlation structures and probability distributions that can be continuous, mixed-type, discrete or even binary. Simulating such processes by reproducing precisely their marginal distribution and linear correlation structure, including features like intermittency, can greatly improve hydrological analysis and design. Traditionally, modelling schemes are case specific and typically attempt to preserve few statistical moments providing inadequate and potentially risky distribution approximations.</em></p>
<p><em>Here, a single framework is proposed that unifies, extends, and improves a general-purpose modelling strategy, based on the assumption that any process can emerge by transforming a specific “parent”&quot; Gaussian process. A novel mathematical representation of this scheme, introducing parametric correlation transformation functions, enables straightforward estimation of the parent-Gaussian process yielding the target process after the marginal back transformation, while it provides a general description that supersedes previous specific parameterizations, offering a simple, fast and efficient simulation procedure for every stationary process at any spatiotemporal scale.</em></p>
<p><em>This framework, also applicable for cyclostationary and multivariate modelling, is augmented with flexible parametric correlation structures that parsimoniously describe observed correlations. Real-world simulations of various hydroclimatic processes with different correlation structures and marginals, such as precipitation, river discharge, wind speed, humidity, extreme events per year, etc., as well as a multivariate example, highlight the flexibility, advantages, and complete generality of the method.</em></p>
<p>From <a href="https://doi.org/10.1016/j.advwatres.2018.02.013">Papalexiou (2018)</a>.</p>
<hr />
<div id="section_1" class="section level1">
<h1><span class="header-section-number">1</span> Step by step guide to timeseries simulation</h1>
<p>The implementation of the stochastic simulation framework follows a few simple steps. Our aim is to generate a time series from a given <a href="https://en.wikipedia.org/wiki/Marginal_distribution">marginal distribution</a>, <a href="https://en.wikipedia.org/wiki/Autocorrelation">autocorrelation function</a> and probability zero. The latter is the probability that a sample value is zero and is commonly used in modelling variables with a substantial number of zero values, such as daily precipitation (intermittent processes).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(CoSMoS)</span></code></pre></div>
<div id="define-marginal-distribution" class="section level2">
<h2><span class="header-section-number">1.1</span> Define marginal distribution</h2>
<p>Marginal distributions have different number of parameters and different type of parameters (location, scale, shape). For example, the <a href="https://en.wikipedia.org/wiki/Generalized_gamma_distribution">Generalized Gamma</a> distribution has one scale and two shape parameters, e.g., <code>margarg = list(scale = 2, shape1 = 0.9, shape2 = 0.8)</code>.</p>
<p>In general, CoSMoS supports all build-in distribution functions of <code>R</code> and of other packages, but also comes with some build-in distributions such as Generalized Gamma or Pareto type II. A list of the <code>CoSMoS</code> distributions with their parameters can be found in <a href="#section_4">Section 4</a>.</p>
<p>Hence, the first step of stochastic simulation with <code>CoSMoS</code> is to set the theoretical distribution that we will simulate, as well as its parameters:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>marginaldist &lt;-<span class="st"> &quot;ggamma&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>param &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">1</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>              <span class="dt">shape1 =</span> <span class="fl">.8</span>,</span>
<span id="cb2-4"><a href="#cb2-4"></a>              <span class="dt">shape2 =</span> <span class="fl">.8</span>)</span></code></pre></div>
</div>
<div id="generate-uncorrelated-time-series" class="section level2">
<h2><span class="header-section-number">1.2</span> Generate uncorrelated time series</h2>
<p>The simplest case is to generate a time series (1000 values) with zero autocorrelation.</p>
<p>This can be done using the random generation <code>rggamma</code> (similarly to <code>rnorm</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>no &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">rggamma</span>(<span class="dt">n =</span> no, </span>
<span id="cb3-3"><a href="#cb3-3"></a>                      <span class="dt">scale =</span> <span class="dv">1</span>, </span>
<span id="cb3-4"><a href="#cb3-4"></a>                      <span class="dt">shape1 =</span> <span class="dv">1</span>, </span>
<span id="cb3-5"><a href="#cb3-5"></a>                      <span class="dt">shape2 =</span> <span class="fl">.5</span>)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">plot.ts</span>(<span class="dt">x =</span> ggamma_sim,</span>
<span id="cb3-7"><a href="#cb3-7"></a>        <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">density</span>(<span class="dt">x =</span> ggamma_sim), </span>
<span id="cb3-12"><a href="#cb3-12"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="kw">acf</span>(<span class="dt">x =</span> ggamma_sim, </span>
<span id="cb3-14"><a href="#cb3-14"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
<div id="autocorrelation" class="section level2">
<h2><span class="header-section-number">1.3</span> Autocorrelation</h2>
<p>We can introduce the autocorrelation structure in two ways. Either by using specific lag autocorrelations as a list starting from lag 0 up to a desired lag, or by using a pre-defined parametric autocorrelation structure.</p>
<p>For instance, a time series with lag-1 autocorrelation <span class="math inline">\(\rho_1 = 0.8\)</span> can be generated by:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>acf &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">generateTS</span>(<span class="dt">n =</span> no,</span>
<span id="cb4-3"><a href="#cb4-3"></a>                         <span class="dt">margdist =</span> marginaldist, </span>
<span id="cb4-4"><a href="#cb4-4"></a>                         <span class="dt">margarg =</span> param,</span>
<span id="cb4-5"><a href="#cb4-5"></a>                         <span class="dt">acsvalue =</span> acf)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">plot</span>(<span class="dt">x =</span> ggamma_sim, </span>
<span id="cb4-7"><a href="#cb4-7"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">density</span>(ggamma_sim[[<span class="dv">1</span>]]),</span>
<span id="cb4-12"><a href="#cb4-12"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="kw">acf</span>(<span class="dt">x =</span> ggamma_sim[[<span class="dv">1</span>]], </span>
<span id="cb4-14"><a href="#cb4-14"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Similarly, we can add more autocorrelation coeficients for a higher number of lags.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>acf &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="co">#up to lag-4</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">generateTS</span>(<span class="dt">n =</span> no,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                         <span class="dt">margdist =</span> marginaldist,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                         <span class="dt">margarg =</span> param,</span>
<span id="cb5-5"><a href="#cb5-5"></a>                         <span class="dt">acsvalue =</span> acf)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">plot</span>(<span class="dt">x =</span> ggamma_sim, </span>
<span id="cb5-7"><a href="#cb5-7"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb5-10"><a href="#cb5-10"></a></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="kw">plot</span>(<span class="kw">density</span>(<span class="dt">x =</span> ggamma_sim[[<span class="dv">1</span>]]),</span>
<span id="cb5-12"><a href="#cb5-12"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="kw">acf</span>(<span class="dt">x =</span> ggamma_sim[[<span class="dv">1</span>]], </span>
<span id="cb5-14"><a href="#cb5-14"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Another, more sophisticated approach is to use a function that creates the autocorrelation structure. This can be done by the <code>acs()</code> function or the user can create his own function. In the case of <code>acs()</code>, four types of autocorrelation functions are provided:</p>
<ul>
<li>Fractional Gaussian Noise (FGN)</li>
<li>Weibull</li>
<li>Pareto II (also known as Lomax)</li>
<li>Burr XII</li>
</ul>
<p>The <code>acs()</code> can produce values of the linear autocorrelation according to this four structures up to a desired lag. Thus, instead of setting each autocorrelation coefficient explicitly, we can fit a model with one to four arguments depending on the selected structure.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">## specify lag</span></span>
<span id="cb6-2"><a href="#cb6-2"></a>lags &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">10</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">## get the ACS</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>f &lt;-<span class="st"> </span><span class="kw">acs</span>(<span class="dt">id =</span> <span class="st">&quot;fgn&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6"></a>         <span class="dt">t =</span> lags,</span>
<span id="cb6-7"><a href="#cb6-7"></a>         <span class="dt">H =</span> <span class="fl">.75</span>)</span>
<span id="cb6-8"><a href="#cb6-8"></a>b &lt;-<span class="st"> </span><span class="kw">acs</span>(<span class="dt">id =</span> <span class="st">&quot;burrXII&quot;</span>, </span>
<span id="cb6-9"><a href="#cb6-9"></a>         <span class="dt">t =</span> lags, </span>
<span id="cb6-10"><a href="#cb6-10"></a>         <span class="dt">scale =</span> <span class="dv">1</span>,</span>
<span id="cb6-11"><a href="#cb6-11"></a>         <span class="dt">shape1 =</span> <span class="fl">.6</span>, </span>
<span id="cb6-12"><a href="#cb6-12"></a>         <span class="dt">shape2 =</span> <span class="fl">.4</span>)</span>
<span id="cb6-13"><a href="#cb6-13"></a>w &lt;-<span class="st"> </span><span class="kw">acs</span>(<span class="dt">id =</span> <span class="st">&quot;weibull&quot;</span>, </span>
<span id="cb6-14"><a href="#cb6-14"></a>         <span class="dt">t =</span> lags,</span>
<span id="cb6-15"><a href="#cb6-15"></a>         <span class="dt">scale =</span> <span class="dv">2</span>,</span>
<span id="cb6-16"><a href="#cb6-16"></a>         <span class="dt">shape =</span> <span class="fl">0.8</span>)</span>
<span id="cb6-17"><a href="#cb6-17"></a>p &lt;-<span class="st"> </span><span class="kw">acs</span>(<span class="dt">id =</span> <span class="st">&quot;paretoII&quot;</span>,</span>
<span id="cb6-18"><a href="#cb6-18"></a>         <span class="dt">t =</span> lags, </span>
<span id="cb6-19"><a href="#cb6-19"></a>         <span class="dt">scale =</span> <span class="dv">3</span>, </span>
<span id="cb6-20"><a href="#cb6-20"></a>         <span class="dt">shape =</span> <span class="fl">0.3</span>)</span>
<span id="cb6-21"><a href="#cb6-21"></a></span>
<span id="cb6-22"><a href="#cb6-22"></a><span class="co">## visualize the ACS</span></span>
<span id="cb6-23"><a href="#cb6-23"></a>dta &lt;-<span class="st"> </span><span class="kw">data.table</span>(lags, f, b, w, p)</span>
<span id="cb6-24"><a href="#cb6-24"></a></span>
<span id="cb6-25"><a href="#cb6-25"></a>m.dta &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data =</span> dta,</span>
<span id="cb6-26"><a href="#cb6-26"></a>              <span class="dt">id.vars =</span> <span class="st">&quot;lags&quot;</span>)</span>
<span id="cb6-27"><a href="#cb6-27"></a></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> m.dta,</span>
<span id="cb6-29"><a href="#cb6-29"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> lags,</span>
<span id="cb6-30"><a href="#cb6-30"></a>                     <span class="dt">y =</span> value,</span>
<span id="cb6-31"><a href="#cb6-31"></a>                     <span class="dt">group =</span> variable,</span>
<span id="cb6-32"><a href="#cb6-32"></a>                     <span class="dt">colour =</span> variable)) <span class="op">+</span></span>
<span id="cb6-33"><a href="#cb6-33"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span></span>
<span id="cb6-34"><a href="#cb6-34"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb6-35"><a href="#cb6-35"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;steelblue4&quot;</span>, <span class="st">&quot;red4&quot;</span>, <span class="st">&quot;green4&quot;</span>, <span class="st">&quot;darkorange&quot;</span>),</span>
<span id="cb6-36"><a href="#cb6-36"></a>                     <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;FGN&quot;</span>, <span class="st">&quot;Burr XII&quot;</span>, <span class="st">&quot;Weibull&quot;</span>, <span class="st">&quot;Pareto II&quot;</span>),</span>
<span id="cb6-37"><a href="#cb6-37"></a>                     <span class="dt">name =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb6-38"><a href="#cb6-38"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="kw">bquote</span>(lag <span class="op">~</span><span class="st"> </span>tau),</span>
<span id="cb6-39"><a href="#cb6-39"></a>       <span class="dt">y =</span> <span class="st">&quot;Acf&quot;</span>) <span class="op">+</span></span>
<span id="cb6-40"><a href="#cb6-40"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> lags) <span class="op">+</span></span>
<span id="cb6-41"><a href="#cb6-41"></a><span class="st">  </span><span class="kw">theme_grey</span>()</span></code></pre></div>
<p>Back to our example, we can implement a 30-lag autocorrelation structure as:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>acf =<span class="st"> </span><span class="kw">acs</span>(<span class="dt">id =</span> <span class="st">&quot;paretoII&quot;</span>,</span>
<span id="cb7-2"><a href="#cb7-2"></a>          <span class="dt">t =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">30</span>,</span>
<span id="cb7-3"><a href="#cb7-3"></a>          <span class="dt">scale =</span> <span class="dv">1</span>,</span>
<span id="cb7-4"><a href="#cb7-4"></a>          <span class="dt">shape =</span> <span class="fl">.75</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">generateTS</span>(<span class="dt">n =</span> no,</span>
<span id="cb7-7"><a href="#cb7-7"></a>                         <span class="dt">margdist =</span> marginaldist,</span>
<span id="cb7-8"><a href="#cb7-8"></a>                         <span class="dt">margarg =</span> param,</span>
<span id="cb7-9"><a href="#cb7-9"></a>                         <span class="dt">acsvalue =</span> acf)</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="kw">plot</span>(<span class="dt">x =</span> ggamma_sim, </span>
<span id="cb7-12"><a href="#cb7-12"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p>Note that in this case we use only 2 parameters for autocorrelation and not 30, which increases our simulation parsimony. More details about the parametric autocorrelation structures can be found in section 3.2 in <a href="https://doi.org/10.1016/j.advwatres.2018.02.013">Papalexiou (2018)</a>.</p>
<p>Except for the four autocorrelation functions provided by <code>acs()</code>, we can also create the our own:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>my_acf &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">-2</span>, <span class="fl">-0.1</span>))</span>
<span id="cb8-2"><a href="#cb8-2"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">generateTS</span>(<span class="dt">n =</span> no,</span>
<span id="cb8-3"><a href="#cb8-3"></a>                         <span class="dt">margdist =</span> marginaldist, </span>
<span id="cb8-4"><a href="#cb8-4"></a>                         <span class="dt">margarg =</span> param,</span>
<span id="cb8-5"><a href="#cb8-5"></a>                         <span class="dt">acsvalue =</span> my_acf)</span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">plot</span>(<span class="dt">x =</span> ggamma_sim,</span>
<span id="cb8-8"><a href="#cb8-8"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="kw">acf</span>(<span class="dt">x =</span> ggamma_sim[[<span class="dv">1</span>]])</span></code></pre></div>
</div>
<div id="intermittency" class="section level2">
<h2><span class="header-section-number">1.4</span> Intermittency</h2>
<p>If we wish to simulate an intermittent process (e.g., precipitation), then we have to define the probability zero. For example, if <code>p0 = 0.9</code>, then generated data shall have 90% of zero values (dry days). In addition, we can simulate multiple processes at once by using argument <code>TSn = 5</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>prob_zero &lt;-<span class="st"> </span><span class="fl">.9</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>ggamma_sim &lt;-<span class="st"> </span><span class="kw">generateTS</span>(<span class="dt">n =</span> no, </span>
<span id="cb9-3"><a href="#cb9-3"></a>                         <span class="dt">margdist =</span> marginaldist,</span>
<span id="cb9-4"><a href="#cb9-4"></a>                         <span class="dt">margarg =</span> param,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                         <span class="dt">acsvalue =</span> acf,</span>
<span id="cb9-6"><a href="#cb9-6"></a>                         <span class="dt">p0 =</span> prob_zero,</span>
<span id="cb9-7"><a href="#cb9-7"></a>                         <span class="dt">TSn =</span> <span class="dv">5</span>)</span>
<span id="cb9-8"><a href="#cb9-8"></a></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="kw">plot</span>(<span class="dt">x =</span> ggamma_sim, </span>
<span id="cb9-12"><a href="#cb9-12"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
</div>
<div id="validating-the-results" class="section level2">
<h2><span class="header-section-number">1.5</span> Validating the results</h2>
<p>The efficiency of the generated time series can be validated with <code>checkTS()</code>. The first three moments, probability zero and the first three autocorrelation coefficients are printed.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">checkTS</span>(ggamma_sim)</span></code></pre></div>
<hr />
</div>
</div>
<div id="section_2" class="section level1">
<h1><span class="header-section-number">2</span> Random vector and random field simulation</h1>
<p>The above framework can readily extended to multidimensional cases, thus enabling the simulation spatiotemporally correlated random vectors (e.g. correlated timeseries at multiple locations) and random fields (e.g. gridded data), as discussed in details by <a href="https://doi.org/10.1029/2019WR026331">Papalexiou and Serinaldi (2020)</a>. Such an extension requires the introduction of suitable spatiotemporal correlation functions (see <a href="https://doi.org/10.1002/wics.1512">Porcu et al. (2020)</a> for a thorough review of this topic).</p>
<div id="spatiotemporal-correlation-functions" class="section level2">
<h2><span class="header-section-number">2.1</span> Spatiotemporal correlation functions</h2>
<p>CoSMoS allows the definition of spatiotemporal correlation functions by the function <code>stcs()</code>, which the spatiotemporal countepart of the purely temporal <code>acs()</code>. Two classes of spatiotemporal correlation functions are provided:</p>
<ul>
<li>Clayton <a href="https://doi.org/10.1029/2019WR026331">(Papalexiou and Serinaldi 2020)</a></li>
<li>Gneiting <a href="https://doi.org/10.1198/016214502760047113">(Gneiting 2002)</a></li>
</ul>
<p>The <code>stcs()</code> can produce values of the linear spatiotemporal correlation up to desired time lag and spatial distance according to this two classes, which comprise a variety of structures covering most of the cases of practical interest.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">library</span>(plotly)</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## specify grid of spatial and temporal lags</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>d &lt;-<span class="st"> </span><span class="dv">31</span></span>
<span id="cb11-5"><a href="#cb11-5"></a>st &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dv">0</span><span class="op">:</span>(d <span class="op">-</span><span class="st"> </span><span class="dv">1</span>),</span>
<span id="cb11-6"><a href="#cb11-6"></a>                  <span class="dv">0</span><span class="op">:</span>(d <span class="op">-</span><span class="st"> </span><span class="dv">1</span>))</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## get the STCS</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>wc &lt;-<span class="st"> </span><span class="kw">stcfclayton</span>(<span class="dt">t =</span> st[, <span class="dv">1</span>],</span>
<span id="cb11-10"><a href="#cb11-10"></a>                  <span class="dt">s =</span> st[, <span class="dv">2</span>],</span>
<span id="cb11-11"><a href="#cb11-11"></a>                  <span class="dt">scfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb11-12"><a href="#cb11-12"></a>                  <span class="dt">tcfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb11-13"><a href="#cb11-13"></a>                  <span class="dt">copulaarg =</span> <span class="dv">2</span>,</span>
<span id="cb11-14"><a href="#cb11-14"></a>                  <span class="dt">scfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">20</span>,</span>
<span id="cb11-15"><a href="#cb11-15"></a>                                <span class="dt">shape =</span> <span class="fl">0.7</span>),</span>
<span id="cb11-16"><a href="#cb11-16"></a>                  <span class="dt">tcfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">1.1</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>                                <span class="dt">shape =</span> <span class="fl">0.8</span>))</span>
<span id="cb11-18"><a href="#cb11-18"></a></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">## visualize the STCS</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>wc.m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> wc,</span>
<span id="cb11-21"><a href="#cb11-21"></a>               <span class="dt">nrow =</span> d)</span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="kw">plot_ly</span>(<span class="dt">z =</span> <span class="op">~</span>wc.m) <span class="op">%&gt;%</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="st">  </span><span class="kw">add_surface</span>() <span class="op">%&gt;%</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="st">  </span><span class="kw">layout</span>(</span>
<span id="cb11-26"><a href="#cb11-26"></a>      <span class="dt">scene =</span> <span class="kw">list</span>(</span>
<span id="cb11-27"><a href="#cb11-27"></a>          <span class="dt">xaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Time lag&quot;</span>),</span>
<span id="cb11-28"><a href="#cb11-28"></a>          <span class="dt">yaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;Distance&quot;</span>),</span>
<span id="cb11-29"><a href="#cb11-29"></a>          <span class="dt">zaxis =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;STCF&quot;</span>)</span>
<span id="cb11-30"><a href="#cb11-30"></a>      )</span>
<span id="cb11-31"><a href="#cb11-31"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="st">  </span><span class="kw">hide_colorbar</span>()</span></code></pre></div>
</div>
<div id="random-vector-simulation" class="section level2">
<h2><span class="header-section-number">2.2</span> Random vector simulation</h2>
<p>Similar to the one-dimensional case (i.e. the function <code>generateTS()</code>), CoSMoS provides an easy to use function, <code>generateMULTI()</code>, to simulate vectors of timeseries with specified (identical) marginals and spatiotemporal correlation function. Since the simulation relies on parent Gaussian Vector AutoRegressive (VAR) models, we need the preliminary computation of VAR parameters <a href="https://doi.org/10.1145/937332.937333">(Biller and Nelson 2003)</a> corresponding to the desired spatiotemporal correlation function of the target process, which done by the function <code>fitVARMULTI()</code>. Therefore, the simulation is as follows</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">## set a sequence of hypothetical coordinates </span></span>
<span id="cb12-2"><a href="#cb12-2"></a>coord &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">runif</span>(<span class="dv">8</span>)<span class="op">*</span><span class="dv">30</span>, </span>
<span id="cb12-3"><a href="#cb12-3"></a>               <span class="kw">runif</span>(<span class="dv">8</span>)<span class="op">*</span><span class="dv">30</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">## compute VAR model parameters  </span></span>
<span id="cb12-6"><a href="#cb12-6"></a>fit &lt;-<span class="st"> </span><span class="kw">fitVARMULTI</span>(</span>
<span id="cb12-7"><a href="#cb12-7"></a>  <span class="dt">coord =</span> coord,</span>
<span id="cb12-8"><a href="#cb12-8"></a>  <span class="dt">p =</span> <span class="dv">5</span>,</span>
<span id="cb12-9"><a href="#cb12-9"></a>  <span class="dt">margdist =</span><span class="st">&quot;burrXII&quot;</span>,</span>
<span id="cb12-10"><a href="#cb12-10"></a>  <span class="dt">margarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">3</span>,</span>
<span id="cb12-11"><a href="#cb12-11"></a>                 <span class="dt">shape1 =</span> <span class="fl">.9</span>,</span>
<span id="cb12-12"><a href="#cb12-12"></a>                 <span class="dt">shape2 =</span> <span class="fl">.2</span>),</span>
<span id="cb12-13"><a href="#cb12-13"></a>  <span class="dt">p0 =</span> <span class="fl">0.8</span>,</span>
<span id="cb12-14"><a href="#cb12-14"></a>  <span class="dt">stcsid =</span> <span class="st">&quot;clayton&quot;</span>,</span>
<span id="cb12-15"><a href="#cb12-15"></a>  <span class="dt">stcsarg =</span> <span class="kw">list</span>(<span class="dt">scfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                 <span class="dt">tcfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb12-17"><a href="#cb12-17"></a>                 <span class="dt">copulaarg =</span> <span class="dv">2</span>,</span>
<span id="cb12-18"><a href="#cb12-18"></a>                 <span class="dt">scfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">25</span>,</span>
<span id="cb12-19"><a href="#cb12-19"></a>                               <span class="dt">shape =</span> <span class="fl">0.7</span>),</span>
<span id="cb12-20"><a href="#cb12-20"></a>                 <span class="dt">tcfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">3.1</span>,</span>
<span id="cb12-21"><a href="#cb12-21"></a>                               <span class="dt">shape =</span> <span class="fl">0.8</span>))</span>
<span id="cb12-22"><a href="#cb12-22"></a>)</span>
<span id="cb12-23"><a href="#cb12-23"></a></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">## generate correlated random vectors  </span></span>
<span id="cb12-25"><a href="#cb12-25"></a>sim &lt;-<span class="st"> </span><span class="kw">generateMULTI</span>(<span class="dt">n =</span> <span class="dv">500</span>,</span>
<span id="cb12-26"><a href="#cb12-26"></a>                     <span class="dt">STmodel =</span> fit)</span>
<span id="cb12-27"><a href="#cb12-27"></a></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="co">## visualize simulated timeseries</span></span>
<span id="cb12-29"><a href="#cb12-29"></a>dta &lt;-<span class="st"> </span><span class="kw">melt</span>(<span class="dt">data =</span> <span class="kw">data.table</span>(<span class="dt">time =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(sim), </span>
<span id="cb12-30"><a href="#cb12-30"></a>                              sim[,<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]), </span>
<span id="cb12-31"><a href="#cb12-31"></a>            <span class="dt">id.vars =</span> <span class="st">&quot;time&quot;</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a></span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dta, </span>
<span id="cb12-34"><a href="#cb12-34"></a>       <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> time, </span>
<span id="cb12-35"><a href="#cb12-35"></a>                     <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="st">       </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb12-37"><a href="#cb12-37"></a><span class="st">       </span><span class="kw">facet_grid</span>(<span class="dt">facets =</span> variable <span class="op">~</span><span class="st"> </span>., </span>
<span id="cb12-38"><a href="#cb12-38"></a>                  <span class="dt">scales =</span> <span class="st">&quot;free_y&quot;</span>) </span></code></pre></div>
</div>
<div id="random-field-simulation" class="section level2">
<h2><span class="header-section-number">2.3</span> Random field simulation</h2>
<p>CoSMoS implement the simulation of spatially and temporally correlated random fields in two main functions called <code>generateSTRF()</code> and <code>generateSTRFsepfast()</code>. <code>generateSTRF()</code> generates random fields with separable or nonseparable STCFs relying on the simulation of parent VAR processes similarly to <code>generateMULTI()</code> (see <a href="https://doi.org/10.1016/j.advwatres.2018.02.013">Papalexiou (2018)</a> and <a href="https://doi.org/10.1029/2019WR026331">Papalexiou and Serinaldi (2020)</a>). The function <code>generateSTRFsepfast()</code> generates RFs with approximately separable STCF <a href="https://doi.org/10.1029/2018WR023055">(Serinaldi and Kilsby 2018)</a>. As the algorithm in <code>generateSTRFsepfast()</code> is computationally less expensive than that implemented in <code>generateSTRF()</code>, it allows the simulation of random fields over a larger number of grid points, at the cost of using separable STCFs and accepting some lack of accuracy in the exact reproduction of some terms of the required STCF <a href="https://doi.org/10.1029/2018WR023055">(Serinaldi and Kilsby 2018)</a>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">## compute VAR model parameters </span></span>
<span id="cb13-2"><a href="#cb13-2"></a>fit &lt;-<span class="st"> </span><span class="kw">fitVARSTRF</span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>  <span class="dt">m =</span> <span class="dv">20</span>,</span>
<span id="cb13-4"><a href="#cb13-4"></a>  <span class="dt">p =</span> <span class="dv">10</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>  <span class="dt">margdist =</span><span class="st">&quot;burrXII&quot;</span>,</span>
<span id="cb13-6"><a href="#cb13-6"></a>  <span class="dt">margarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">3</span>,</span>
<span id="cb13-7"><a href="#cb13-7"></a>                 <span class="dt">shape1 =</span> <span class="fl">.9</span>, </span>
<span id="cb13-8"><a href="#cb13-8"></a>                 <span class="dt">shape2 =</span> <span class="fl">.2</span>),</span>
<span id="cb13-9"><a href="#cb13-9"></a>  <span class="dt">p0 =</span> <span class="fl">0.8</span>,</span>
<span id="cb13-10"><a href="#cb13-10"></a>  <span class="dt">stcsid =</span> <span class="st">&quot;clayton&quot;</span>,</span>
<span id="cb13-11"><a href="#cb13-11"></a>  <span class="dt">stcsarg =</span> <span class="kw">list</span>(<span class="dt">scfid =</span> <span class="st">&quot;weibull&quot;</span>, </span>
<span id="cb13-12"><a href="#cb13-12"></a>                 <span class="dt">tcfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb13-13"><a href="#cb13-13"></a>                 <span class="dt">copulaarg =</span> <span class="dv">2</span>,</span>
<span id="cb13-14"><a href="#cb13-14"></a>                 <span class="dt">scfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">20</span>,</span>
<span id="cb13-15"><a href="#cb13-15"></a>                               <span class="dt">shape =</span> <span class="fl">0.7</span>),</span>
<span id="cb13-16"><a href="#cb13-16"></a>                 <span class="dt">tcfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">1.1</span>, </span>
<span id="cb13-17"><a href="#cb13-17"></a>                               <span class="dt">shape =</span> <span class="fl">0.8</span>))</span>
<span id="cb13-18"><a href="#cb13-18"></a>)</span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">## generate random fields with nonseparable correlation structure </span></span>
<span id="cb13-20"><a href="#cb13-20"></a>sim1 &lt;-<span class="st"> </span><span class="kw">generateSTRF</span>(<span class="dt">n =</span> <span class="dv">1000</span>,</span>
<span id="cb13-21"><a href="#cb13-21"></a>                     <span class="dt">STmodel =</span> fit)</span>
<span id="cb13-22"><a href="#cb13-22"></a></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">## fast simulation of random fields with separable correlation structure</span></span>
<span id="cb13-24"><a href="#cb13-24"></a>sim2 &lt;-<span class="st"> </span><span class="kw">generateSTRFsepfast</span>(</span>
<span id="cb13-25"><a href="#cb13-25"></a>    <span class="dt">n =</span> <span class="dv">1000</span>,</span>
<span id="cb13-26"><a href="#cb13-26"></a>    <span class="dt">m =</span> <span class="dv">20</span>,</span>
<span id="cb13-27"><a href="#cb13-27"></a>    <span class="dt">p0 =</span> <span class="fl">0.7</span>,</span>
<span id="cb13-28"><a href="#cb13-28"></a>    <span class="dt">margdist =</span><span class="st">&quot;paretoII&quot;</span>,</span>
<span id="cb13-29"><a href="#cb13-29"></a>    <span class="dt">margarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">1</span>,</span>
<span id="cb13-30"><a href="#cb13-30"></a>                   <span class="dt">shape =</span> <span class="fl">.3</span>),</span>
<span id="cb13-31"><a href="#cb13-31"></a>    <span class="dt">stcsarg =</span> <span class="kw">list</span>(<span class="dt">scfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb13-32"><a href="#cb13-32"></a>                   <span class="dt">tcfid =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb13-33"><a href="#cb13-33"></a>                   <span class="dt">scfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="dv">20</span>,</span>
<span id="cb13-34"><a href="#cb13-34"></a>                                 <span class="dt">shape =</span> <span class="fl">0.7</span>),</span>
<span id="cb13-35"><a href="#cb13-35"></a>                   <span class="dt">tcfarg =</span> <span class="kw">list</span>(<span class="dt">scale =</span> <span class="fl">1.1</span>,</span>
<span id="cb13-36"><a href="#cb13-36"></a>                                 <span class="dt">shape =</span> <span class="fl">0.8</span>))</span>
<span id="cb13-37"><a href="#cb13-37"></a>)</span>
<span id="cb13-38"><a href="#cb13-38"></a></span>
<span id="cb13-39"><a href="#cb13-39"></a><span class="kw">checkSTRF</span>(<span class="dt">STRF =</span> sim2)</span></code></pre></div>
</div>
<div id="validating-the-simulated-random-fields" class="section level2">
<h2><span class="header-section-number">2.4</span> Validating the simulated random fields</h2>
<p>The properties of the generated time series can be checked with <code>checkSTRF()</code>. The first three moments, and the probability zero at several grid points are printed. <code>checkSTRF()</code> also returns a multi-panel plot comparing theoretical and empirical spatial correlation functions at 0, 1, and 2 time lags, and the empirical and target CDFs. The graphical output also yields the contour plot of the target STCF, and level plots of 80 consecutive simulated RFs to visualize the temporal persistence of spatial patterns.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">## check random fields  </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">checkSTRF</span>(sim1)</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="kw">checkSTRF</span>(sim2)</span></code></pre></div>
<hr />
</div>
</div>
<div id="section_3" class="section level1">
<h1><span class="header-section-number">3</span> Stochastic Simulation of real-world processes</h1>
<div id="hourly-precipitation" class="section level2">
<h2><span class="header-section-number">3.1</span> Hourly precipitation</h2>
<p>In practice, we usually want to simulate a natural process using some sampled time series. A typical hydroclimatic variable, also available in <code>CoSMoS</code> package is daily precipitation.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">data</span>(<span class="st">&quot;precip&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">plot</span>(<span class="dt">x =</span> precip,</span>
<span id="cb15-3"><a href="#cb15-3"></a>     <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">density</span>(<span class="dt">x =</span> precip<span class="op">$</span>value),</span>
<span id="cb15-8"><a href="#cb15-8"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, </span>
<span id="cb15-9"><a href="#cb15-9"></a>     <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">10</span>)) <span class="co">#Does not plot extreme values</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="kw">acf</span>(<span class="dt">x =</span> precip<span class="op">$</span>value, </span>
<span id="cb15-11"><a href="#cb15-11"></a>    <span class="dt">main =</span> <span class="st">&quot;&quot;</span>, <span class="dt">lag.max =</span> <span class="dv">20</span>)</span></code></pre></div>
<p>To generate a synthetic time series with similar characteristics to the observed precipitation, we have to determine their marginal distribution, autocorrelation structure and probability zero for each individual month. This can be done by trying to fit various distributions and autocorrelation structures with <code>analyzeTS()</code> and then check the goodness-of-fit with <code>reportTS()</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>precip_ggamma &lt;-<span class="st"> </span><span class="kw">analyzeTS</span>(<span class="dt">TS =</span> precip, </span>
<span id="cb16-2"><a href="#cb16-2"></a>                                <span class="dt">season =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb16-3"><a href="#cb16-3"></a>                                <span class="dt">dist =</span> <span class="st">&quot;ggamma&quot;</span>,</span>
<span id="cb16-4"><a href="#cb16-4"></a>                                <span class="dt">acsID =</span> <span class="st">&quot;weibull&quot;</span>,</span>
<span id="cb16-5"><a href="#cb16-5"></a>                                <span class="dt">lag.max =</span> <span class="dv">12</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="kw">reportTS</span>(<span class="dt">aTS =</span> precip_ggamma, </span>
<span id="cb16-8"><a href="#cb16-8"></a>         <span class="dt">method =</span> <span class="st">&quot;dist&quot;</span>)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="kw">reportTS</span>(<span class="dt">aTS =</span> precip_ggamma,</span>
<span id="cb16-10"><a href="#cb16-10"></a>         <span class="dt">method =</span> <span class="st">&quot;acs&quot;</span>)</span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="kw">reportTS</span>(<span class="dt">aTS =</span> precip_ggamma, </span>
<span id="cb16-12"><a href="#cb16-12"></a>         <span class="dt">method =</span> <span class="st">&quot;stat&quot;</span>)</span></code></pre></div>
<p>In this example, the Generalized Gamma distribution, with a Weibull auto-correlation structure, appears to fit well to the observered time series. Other combinations might not give so good results. For instance:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>precip_pareto &lt;-<span class="st"> </span><span class="kw">analyzeTS</span>(<span class="dt">TS =</span> precip, </span>
<span id="cb17-2"><a href="#cb17-2"></a>                           <span class="dt">season =</span> <span class="st">&quot;month&quot;</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>                           <span class="dt">dist =</span> <span class="st">&quot;paretoII&quot;</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>                           <span class="dt">acsID =</span> <span class="st">&quot;fgn&quot;</span>,</span>
<span id="cb17-5"><a href="#cb17-5"></a>                           <span class="dt">lag.max =</span> <span class="dv">12</span>)</span>
<span id="cb17-6"><a href="#cb17-6"></a></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="kw">reportTS</span>(<span class="dt">aTS =</span> precip_pareto,</span>
<span id="cb17-8"><a href="#cb17-8"></a>         <span class="dt">method =</span> <span class="st">&quot;dist&quot;</span>)</span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="kw">reportTS</span>(<span class="dt">aTS =</span> precip_pareto, </span>
<span id="cb17-10"><a href="#cb17-10"></a>         <span class="dt">method =</span> <span class="st">&quot;acs&quot;</span>)</span></code></pre></div>
<p>When the marginal distribution and the autocorrelation structure with the best fit are determined, we can produce a synthetic time series with the same statistical properties with <code>simulateTS()</code> for a given period.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>sim_precip &lt;-<span class="st"> </span><span class="kw">simulateTS</span>(<span class="dt">aTS =</span> precip_ggamma, </span>
<span id="cb18-2"><a href="#cb18-2"></a>                         <span class="dt">from =</span> <span class="kw">as.POSIXct</span>(<span class="dt">x =</span> <span class="st">&quot;1978-12-01 00:00:00&quot;</span>),</span>
<span id="cb18-3"><a href="#cb18-3"></a>                         <span class="dt">to =</span> <span class="kw">as.POSIXct</span>(<span class="dt">x =</span> <span class="st">&quot;2008-12-01 00:00:00&quot;</span>))</span>
<span id="cb18-4"><a href="#cb18-4"></a>dta &lt;-<span class="st"> </span>precip</span>
<span id="cb18-5"><a href="#cb18-5"></a>dta[, id <span class="op">:</span><span class="er">=</span><span class="st"> &quot;observed&quot;</span>]</span>
<span id="cb18-6"><a href="#cb18-6"></a>sim_precip[, id <span class="op">:</span><span class="er">=</span><span class="st"> &quot;simulated&quot;</span>]</span>
<span id="cb18-7"><a href="#cb18-7"></a></span>
<span id="cb18-8"><a href="#cb18-8"></a>dta &lt;-<span class="st"> </span><span class="kw">rbind</span>(dta, sim_precip)</span>
<span id="cb18-9"><a href="#cb18-9"></a></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dta) <span class="op">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> date, </span>
<span id="cb18-12"><a href="#cb18-12"></a>                          <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="op">~</span>id,</span>
<span id="cb18-14"><a href="#cb18-14"></a>             <span class="dt">ncol =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">  </span><span class="kw">theme_classic</span>()</span></code></pre></div>
</div>
<div id="daily-streamflow" class="section level2">
<h2><span class="header-section-number">3.2</span> Daily streamflow</h2>
<p>We can also apply the same methods to a different dataset - daily streamflow! For this example we have used random dataset from the MOPEX database <a href="https://www.nws.noaa.gov/oh/mopex/mo_datasets.htm">(https://www.nws.noaa.gov/oh/mopex/mo_datasets.htm)</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co"># id &lt;- &quot;06606600&quot;</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co"># dta_raw &lt;- as.data.table(read.fwf(file = sprintf(</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#   &quot;https://hydrology.nws.noaa.gov/pub/gcip/mopex/US_Data/Us_438_Daily/%s.dly&quot;, id),</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#                                   widths = c(8,10,10,10,10,10),</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#                                   col.names = c(&quot;date&quot;, &quot;P&quot;, &quot;E&quot;, &quot;value&quot;, &quot;Tmax&quot;, &quot;Tmin&quot;)</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#   )</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co"># )</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co"># </span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co"># dta_raw[, date := as.POSIXct(gsub(pattern = &quot; &quot;,</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="co">#                                   replacement = &quot;0&quot;, </span></span>
<span id="cb19-11"><a href="#cb19-11"></a><span class="co">#                                   x = date), </span></span>
<span id="cb19-12"><a href="#cb19-12"></a><span class="co">#                              format = &quot;%Y%m%d&quot;)]</span></span>
<span id="cb19-13"><a href="#cb19-13"></a><span class="co"># </span></span>
<span id="cb19-14"><a href="#cb19-14"></a><span class="co"># daily_streamflow &lt;- dta_raw[value &gt;= 0, .(date, value)]</span></span>
<span id="cb19-15"><a href="#cb19-15"></a><span class="co"># daily_streamflow &lt;- daily_streamflow[1:1000,]</span></span>
<span id="cb19-16"><a href="#cb19-16"></a><span class="co"># </span></span>
<span id="cb19-17"><a href="#cb19-17"></a><span class="co"># str &lt;- analyzeTS(TS = daily_streamflow,</span></span>
<span id="cb19-18"><a href="#cb19-18"></a><span class="co">#                  dist = &quot;paretoII&quot;,</span></span>
<span id="cb19-19"><a href="#cb19-19"></a><span class="co">#                  norm = &quot;N2&quot;,</span></span>
<span id="cb19-20"><a href="#cb19-20"></a><span class="co">#                  acsID = &quot;paretoII&quot;,</span></span>
<span id="cb19-21"><a href="#cb19-21"></a><span class="co">#                  lag.max = 20,</span></span>
<span id="cb19-22"><a href="#cb19-22"></a><span class="co">#                  constrain = TRUE)</span></span>
<span id="cb19-23"><a href="#cb19-23"></a><span class="co"># </span></span>
<span id="cb19-24"><a href="#cb19-24"></a><span class="co"># reportTS(aTS = str)</span></span>
<span id="cb19-25"><a href="#cb19-25"></a><span class="co"># </span></span>
<span id="cb19-26"><a href="#cb19-26"></a><span class="co"># sim_str &lt;- simulateTS(aTS = str)</span></span>
<span id="cb19-27"><a href="#cb19-27"></a><span class="co"># </span></span>
<span id="cb19-28"><a href="#cb19-28"></a><span class="co"># dta &lt;- daily_streamflow</span></span>
<span id="cb19-29"><a href="#cb19-29"></a><span class="co"># dta[, id := &quot;observed&quot;]</span></span>
<span id="cb19-30"><a href="#cb19-30"></a><span class="co"># sim_str[, id := &quot;simulated&quot;]</span></span>
<span id="cb19-31"><a href="#cb19-31"></a><span class="co"># </span></span>
<span id="cb19-32"><a href="#cb19-32"></a><span class="co"># dta &lt;- rbind(dta, sim_str)</span></span>
<span id="cb19-33"><a href="#cb19-33"></a><span class="co"># </span></span>
<span id="cb19-34"><a href="#cb19-34"></a><span class="co"># ggplot(data = dta) +</span></span>
<span id="cb19-35"><a href="#cb19-35"></a><span class="co">#   geom_line(mapping = aes(x = date,</span></span>
<span id="cb19-36"><a href="#cb19-36"></a><span class="co">#                           y = value)) +</span></span>
<span id="cb19-37"><a href="#cb19-37"></a><span class="co">#   facet_wrap(facets = ~id,</span></span>
<span id="cb19-38"><a href="#cb19-38"></a><span class="co">#              ncol = 1) +</span></span>
<span id="cb19-39"><a href="#cb19-39"></a><span class="co">#   theme_classic()</span></span></code></pre></div>
<p><strong>Recomended distributions for variables:</strong></p>
<ul>
<li><em>precipitation</em>: ggamma (Generalized Gamma), burr### (Burr type)<br />
</li>
<li><em>streamflow</em>: ggamma (Generalized Gamma), burr### (Burr type)<br />
</li>
<li><em>relative humidity</em>: beta<br />
</li>
<li><em>temperature</em>: norm (Normal distribution)</li>
</ul>
</div>
</div>
<div id="section_4" class="section level1">
<h1><span class="header-section-number">4</span> Available distributions in CoSMoS package</h1>
<p>Package CoSMoS supports majority of continuous distributions available in R with defined quantile and probability density functions. We also provide four widely used distributions - Burr type III and XII, Generalized gamma and Pareto type II distribution.</p>
<div id="burr-type-iii-distribution" class="section level2">
<h2><span class="header-section-number">4.1</span> Burr type III distribution</h2>
<p>distribution argument/name - burrIII<br />
parameters - list(scale, shape1, shape2)</p>
<p><span class="math display">\[f_{\text{BrIII}}(x)=\frac{\left(\frac{x}{\beta }\right)^{-\frac{1}{\gamma _2}-1} \left(\frac{\left(\frac{x}{\beta }\right)^{-\frac{1}{\gamma _2}}}{\gamma _1}+1\right){}^{-\gamma _1 \gamma _2-1}}{\beta } \\ F_{\text{BrIII}}(x)=\left(\frac{\left(\frac{x}{\beta }\right)^{-\frac{1}{\gamma _2}}}{\gamma _1}+1\right){}^{-\gamma _1 \gamma _2} \\ Q_{\text{BrIII}}(u)=\beta  \left(\gamma _1 \left(u^{-\frac{1}{\gamma _1 \gamma _2}}-1\right)\right){}^{-\gamma _2} \\
m_{\text{BrIII}}(q)=\frac{\beta ^q \gamma _1^{\gamma _2 (-q)} \Gamma \left(\left(q+\gamma _1\right) \gamma _2\right) \Gamma \left(1-q \gamma _2\right)}{\Gamma \left(\gamma _1 \gamma _2\right)}\]</span></p>
</div>
<div id="burr-type-xii-distribution" class="section level2">
<h2><span class="header-section-number">4.2</span> Burr type XII distribution</h2>
<p>distribution argument/name - burrXII<br />
parameters - list(scale, shape1, shape2)</p>
<p><span class="math display">\[f_{\text{BrXII}}(x)=\frac{\left(\frac{x}{\beta }\right)^{\gamma _1-1} \left(\gamma _2 \left(\frac{x}{\beta }\right)^{\gamma _1}+1\right){}^{-\frac{1}{\gamma _1 \gamma _2}-1}}{\beta } \\
F_{\text{BrXII}}(x)=1-\left(\gamma _2 \left(\frac{x}{\beta }\right)^{\gamma _1}+1\right){}^{-\frac{1}{\gamma _1 \gamma _2}} \\ 
Q_{\text{BrXII}}(u)=\beta  \left(-\frac{1-(1-u)^{-\gamma _1 \gamma _2}}{\gamma _2}\right){}^{\frac{1}{\gamma _1}} \\
m_{\text{BrXII}}(q)=\frac{\beta ^q \gamma _2^{-\frac{q}{\gamma _1}-1} B\left(\frac{q+\gamma _1}{\gamma _1},\frac{1-q \gamma _2}{\gamma _1 \gamma _2}\right)}{\gamma _1}\]</span></p>
</div>
<div id="generalized-gamma-distribution" class="section level2">
<h2><span class="header-section-number">4.3</span> Generalized gamma distribution</h2>
<p>distribution argument/name - ggamma<br />
parameters - list(scale, shape1, shape2)</p>
<p><span class="math display">\[f_{\mathcal{G}\mathcal{G}}(x)=\frac{\gamma _2 e^{-\left(\frac{x}{\beta }\right)^{\gamma _2}} \left(\frac{x}{\beta }\right)^{\gamma _1-1}}{\beta  \Gamma \left(\frac{\gamma _1}{\gamma _2}\right)} \\
F_{\mathcal{G}\mathcal{G}}(x)=Q\left(\frac{\gamma _1}{\gamma _2},0,\left(\frac{x}{\beta }\right)^{\gamma _2}\right) \\ 
Q_{\mathcal{G}\mathcal{G}}(u)=\beta  Q^{-1}\left(\frac{\gamma _1}{\gamma _2},0,u\right){}^{\frac{1}{\gamma _2}} \\ 
m_{\mathcal{G}\mathcal{G}}(q)=\frac{\beta ^q \Gamma \left(\frac{q}{\gamma _2}+\frac{\gamma _1}{\gamma _2}\right)}{\Gamma \left(\frac{\gamma _1}{\gamma _2}\right)}\]</span></p>
</div>
<div id="paretto-type-ii-distribution" class="section level2">
<h2><span class="header-section-number">4.4</span> Paretto type II distribution</h2>
<p>distribution argument/name - burrIII<br />
parameters - list(scale, shape)</p>
<p><span class="math display">\[f_{\text{PII}}(x)=\frac{\left(\frac{\gamma  x}{\beta }+1\right)^{-\frac{1}{\gamma }-1}}{\beta } \\
F_{\text{PII}}(x)=1-\left(\frac{\gamma  x}{\beta }+1\right)^{-1/\gamma } \\
Q_{\text{PII}}(u)=\frac{\beta  \left((1-u)^{-\gamma }-1\right)}{\gamma } \\
m_{\text{PII}}(q)=\frac{\Gamma (q+1) \left(\frac{\beta }{\gamma }\right)^q \Gamma \left(\frac{1}{\gamma }-q\right)}{\Gamma \left(\frac{1}{\gamma }\right)}\]</span></p>
</div>
</div>
<div id="references" class="section level1">
<h1><span class="header-section-number">5</span> References</h1>
<p>Papalexiou, S.M., 2018. Unified theory for stochastic modelling of hydroclimatic processes: Preserving marginal distributions, correlation structures, and intermittency. Advances in Water Resources 115, 234-252. <a href="https://doi.org/10.1016/j.advwatres.2018.02.013">link</a></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
